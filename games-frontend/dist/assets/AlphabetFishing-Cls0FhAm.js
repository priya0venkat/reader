import{r as i,j as n,u as V}from"./index-DlPqXysq.js";import{c as q}from"./confetti.module-oQXWb4Lk.js";import{T as ee}from"./piper-tts-web-Cs0vpiTt.js";const te=({letter:e,onClick:t,position:o})=>{const[a,l]=i.useState({x:0,y:0});return i.useEffect(()=>{const c=setInterval(()=>{l({x:Math.random()*20-10,y:Math.random()*20-10})},2e3);return()=>clearInterval(c)},[]),n.jsxs("div",{onClick:()=>t(e),style:{position:"absolute",left:`${o.x}%`,top:`${o.y}%`,transform:`translate(${a.x}px, ${a.y}px)`,transition:"transform 2s ease-in-out",cursor:"pointer",width:"100px",height:"80px",display:"flex",alignItems:"center",justifyContent:"center",filter:"drop-shadow(0px 4px 6px rgba(0,0,0,0.2))"},children:[n.jsxs("svg",{width:"100%",height:"100%",viewBox:"0 0 100 80",style:{position:"absolute",top:0,left:0,zIndex:-1},children:[n.jsx("path",{d:"M85,40 Q85,10 60,10 Q30,10 10,40 Q30,70 60,70 Q85,70 85,40 Z M85,40 L95,20 L95,60 Z",fill:"rgba(255, 255, 255, 0.25)",stroke:"rgba(255, 255, 255, 0.6)",strokeWidth:"3"}),n.jsx("circle",{cx:"30",cy:"30",r:"3",fill:"white"})]}),n.jsx("span",{style:{fontSize:"3rem",fontWeight:"bold",color:"#fff",textShadow:"0 0 5px rgba(0,0,0,0.5)",zIndex:1,paddingLeft:"10px"},children:e})]})},ne=({score:e,totalAttempts:t})=>{const o=t>0?Math.round(e/t*100):100;return n.jsxs("div",{style:{position:"absolute",top:"20px",left:"20px",background:"rgba(255, 255, 255, 0.8)",padding:"10px 20px",borderRadius:"15px",display:"flex",gap:"20px",fontSize:"1.5rem",fontWeight:"bold",color:"#333",zIndex:100,boxShadow:"0 4px 6px rgba(0,0,0,0.1)"},children:[n.jsxs("div",{children:["Score: ",e]}),n.jsxs("div",{children:["Accuracy: ",o,"%"]})]})},oe={A:"Aa",B:"Buh",C:"Kuh",D:"Duh",E:"Eh",F:"Fuh",G:"Guh",H:"Huh",I:"Ih",J:"Juh",K:"Kuh",L:"Luh",M:"Muh",N:"Nuh",O:"Aw",P:"Puh",Q:"Kwuh",R:"Ruh",S:"Suh",T:"Tuh",U:"Uh",V:"Vuh",W:"Wuh",X:"Ks",Y:"Yuh",Z:"Zuh"};let g=null,A=!1,I=null;const E=()=>(I||(I=new(window.AudioContext||window.webkitAudioContext)),I),se=()=>{const e=E();e.state==="suspended"&&e.resume();const t=e.createBuffer(1,1,22050),o=e.createBufferSource();o.buffer=t,o.connect(e.destination),o.start(0)},re=async e=>{if(g)return"Ready";if(A)return"Initializing...";A=!0;try{return e&&e("Initializing Audio..."),g=new ee({voiceId:"en_US-amy-low",progress:t=>{const o=Math.round(t),a=isNaN(o)||!isFinite(o)?"...":`${o}%`;e&&e(`Loading: ${a}`)},logger:t=>console.log("[Piper]",t),wasmPaths:{onnxWasm:`${window.location.origin}/onnx/`,piperData:`${window.location.origin}/piper/piper_phonemize.data`,piperWasm:`${window.location.origin}/piper/piper_phonemize.wasm`}}),await g.init(),A=!1,e&&e("Ready"),"Ready"}catch(t){console.error("Failed to init Piper:",t),A=!1,g=null;const o=t.message||"Unknown Error";throw e&&e(`Failed: ${o.slice(0,20)}...`),t}},L=async e=>{const t=E();if(t.state==="suspended")try{await t.resume()}catch(o){console.warn("Could not resume audio context",o)}if(!g){console.warn("Piper not initialized, trying fallback");const o=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(o);return}try{if(typeof e!="string"||!e.trim()){console.warn("Invalid text to speak:",e);return}const a=await(await g.predict(e)).arrayBuffer(),l=await t.decodeAudioData(a),c=t.createBufferSource();c.buffer=l,c.connect(t.destination),c.start(0)}catch(o){console.error("Piper speak error:",o);const a=new SpeechSynthesisUtterance(e);window.speechSynthesis.speak(a)}},ie=e=>oe[e.toUpperCase()]||e,ae=e=>e.replace(/\b([a-zA-Z])\b/g,t=>ie(t)),ce="ABCDEFGHIJKLMNOPQRSTUVWXYZ".split(""),le="abcdefghijklmnopqrstuvwxyz".split(""),de="123456789".split("").concat(["10"]),he=({onGoBack:e,gameMode:t="capital"})=>{const[o,a]=i.useState(0),[l,c]=i.useState(0),[h,w]=i.useState(""),[S,P]=i.useState([]),[k,F]=i.useState("Initializing Audio...");i.useEffect(()=>{re(s=>{F(s)}).catch(s=>{console.error("Audio init failed",s)})},[]);const x=i.useCallback(s=>{const r=ae(s);L(r)},[]),j=i.useRef([]),f=i.useCallback((s,r)=>{const p=setTimeout(()=>{s(),j.current=j.current.filter(d=>d!==p)},r);j.current.push(p)},[]);i.useEffect(()=>()=>{j.current.forEach(clearTimeout)},[]);const $=i.useCallback(s=>{if(s.length===0){f(M,1e3);return}const r=s[Math.floor(Math.random()*s.length)];w(r.char),x(`Fish me ${r.char}`)},[x,f]),M=i.useCallback(()=>{const s=6+Math.floor(Math.random()*3),r=[],p=(y,C,v)=>{for(const m of v){const b=Math.abs(y-m.x),z=Math.abs(C-m.y);if(b<12&&z<15)return!1}return!0};let d=[];t==="small"?d=[...le]:t==="number"?d=[...de]:d=[...ce];const u=[...d],N=window.innerWidth,D=window.innerHeight,G=120,U=100,_=5,K=G/N*100,Q=100-_-K,R=5,X=5,Y=U/D*100,Z=100-X-Y,B=25;for(let y=0;y<s;y++){const C=Math.floor(Math.random()*u.length),v=u[C];u.splice(C,1);let m,b,z=!1,T=0;const O=Math.max(0,Q-R),J=Math.max(0,Z-B);for(;!z&&T<50;)m=Math.random()*O+R,b=Math.random()*J+B,p(m,b,r)&&(z=!0),T++;r.push({char:v,id:`${v}-${Date.now()}-${y}`,x:m,y:b})}P(r),f(()=>$(r),1e3)},[$,f]);i.useEffect(()=>{M()},[M]);const W=s=>{if(c(r=>r+1),s.char===h){a(u=>u+1),q({particleCount:50,spread:50,origin:{x:s.x/100,y:s.y/100}});const r=S.filter(u=>u.id!==s.id);P(r);const p=["Good job!","Great!","Awesome!","You got it!"],d=p[Math.floor(Math.random()*p.length)];x(`${d}`),r.length>0?f(()=>$(r),1500):(x("All cleared! Next round."),f(M,2e3))}else x(`That is ${s.char}. Try finding ${h}`)},H=()=>{x(`Fish me ${h}`)};return n.jsxs("div",{style:{width:"100%",height:"100%",position:"relative"},children:[n.jsx(ne,{score:o,totalAttempts:l}),n.jsx("div",{style:{position:"absolute",top:"5px",left:"50%",transform:"translateX(-50%)",fontSize:"0.8rem",color:"#666",zIndex:90},children:k!=="Ready"&&k}),h&&n.jsxs("div",{style:{position:"absolute",top:"90px",left:"50%",transform:"translateX(-50%)",background:"rgba(255, 255, 255, 0.9)",padding:"10px 30px",borderRadius:"50px",fontSize:"2rem",fontWeight:"bold",color:"#333",zIndex:100,boxShadow:"0 4px 10px rgba(0,0,0,0.2)",display:"flex",alignItems:"center",gap:"10px"},children:[n.jsx("span",{children:"Fish me"}),n.jsx("span",{style:{color:"#E63946",fontSize:"2.5rem"},children:h})]}),n.jsxs("div",{style:{position:"absolute",top:"20px",right:"20px",zIndex:100,display:"flex",gap:"10px"},children:[n.jsx("button",{onClick:H,style:{padding:"10px 20px",fontSize:"1.2rem"},children:"ðŸ”Š Hear Again"}),n.jsx("button",{onClick:e,style:{padding:"10px 20px",fontSize:"1.2rem"},children:"Exit"})]}),S.map(s=>n.jsx(te,{letter:s.char,position:{x:s.x,y:s.y},onClick:()=>W(s)},s.id))]})},pe=({onStart:e})=>{const t=o=>{se(),L("Welcome"),e(o)};return n.jsxs("div",{style:{display:"flex",flexDirection:"column",alignItems:"center",justifyContent:"center",height:"100%",zIndex:10},children:[n.jsx("h1",{style:{fontSize:"4rem",color:"white",textShadow:"2px 2px 4px rgba(0,0,0,0.5)"},children:"Alphabet Fishing"}),n.jsx("p",{style:{fontSize:"1.5rem",marginBottom:"2rem"},children:"Catch the letters!"}),n.jsxs("div",{style:{display:"flex",gap:"20px",flexWrap:"wrap",justifyContent:"center"},children:[n.jsx("button",{onClick:()=>t("capital"),style:{fontSize:"1.5rem",padding:"1rem 2rem",borderRadius:"50px",background:"#FFD700",border:"none",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",cursor:"pointer"},children:"Capital Letters"}),n.jsx("button",{onClick:()=>t("small"),style:{fontSize:"1.5rem",padding:"1rem 2rem",borderRadius:"50px",background:"#4CC9F0",color:"white",border:"none",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",cursor:"pointer"},children:"Small Letters"}),n.jsx("button",{onClick:()=>t("number"),style:{fontSize:"1.5rem",padding:"1rem 2rem",borderRadius:"50px",background:"#F72585",color:"white",border:"none",boxShadow:"0 4px 6px rgba(0,0,0,0.3)",cursor:"pointer"},children:"Numbers 1-10"})]})]})};function me(){const[e,t]=i.useState(!1),[o,a]=i.useState("capital"),l=V(),c=w=>{a(w),t(!0)},h=()=>{e?t(!1):l("/")};return n.jsxs("div",{style:{width:"100vw",height:"100vh",position:"relative",overflow:"hidden"},children:[[...Array(10)].map((w,S)=>n.jsx("div",{className:"bubble",style:{left:`${Math.random()*100}%`,width:`${Math.random()*50+20}px`,height:`${Math.random()*50+20}px`,animationDuration:`${Math.random()*5+5}s`,animationDelay:`${Math.random()*5}s`}},S)),e?n.jsx(he,{onGoBack:h,gameMode:o}):n.jsx(pe,{onStart:c,onGoHome:()=>l("/")})]})}export{me as default};
